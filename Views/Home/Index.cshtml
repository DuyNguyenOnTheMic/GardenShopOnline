@model IEnumerable<GardenShopOnline.Models.Product>

@{
    ViewBag.Title = "Trang chủ";
    var category = new SelectList(ViewBag.Catgory,"ID", "Name");
    var type = new SelectList(ViewBag.Type, "ID", "Name");
}

<!-- Begin Slider Area -->
<div class="slider-area">

    <!-- Main Slider -->
    <div class="swiper-container main-slider swiper-arrow with-bg_white">
        <div class="swiper-wrapper">
            <div class="swiper-slide animation-style-01">
                <div class="slide-inner style-1 bg-height" data-bg-image="../../assets/customer/images/slider/bg/1-1.jpg">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-6 order-2 order-lg-1 align-self-center">
                                <div class="slide-content text-black">
                                    <span class="offer">65% Off</span>
                                    <h2 class="title">New Plant</h2>
                                    <p class="short-desc">Pronia, With 100% Natural, Organic & Plant Shop.</p>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-8 offset-md-2 offset-lg-0 order-1 order-lg-2">
                                <div class="inner-img">
                                    <div class="scene fill">
                                        <div class="expand-width" data-depth="0.2">
                                            <img src="~/assets/customer/images/slider/inner-img/New.png" alt="Inner Image">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-slide animation-style-01">
                <div class="slide-inner style-1 bg-height" data-bg-image="../../assets/customer/images/slider/bg/1-1.jpg">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-6 order-2 order-lg-1 align-self-center">
                                <div class="slide-content text-black">
                                    <span class="offer">65% Off</span>
                                    <h2 class="title">New Plant</h2>
                                    <p class="short-desc">Pronia, With 100% Natural, Organic & Plant Shop.</p>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-8 offset-md-2 offset-lg-0 order-1 order-lg-2">
                                <div class="inner-img">
                                    <div class="scene fill">
                                        <div class="expand-width" data-depth="0.2">
                                            <img src="~/assets/customer/images/slider/inner-img/New2.png" alt="Inner Image">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination d-md-none"></div>
        <!-- Add Arrows -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>

</div>
<!-- Slider Area End Here -->
<!-- Begin Shipping Area -->
<div class="shipping-area section-space-top-100">
    <div class="container">
        <div class="shipping-bg">
            <div class="row shipping-wrap">
                <div class="col-lg-4 col-md-6">
                    <div class="shipping-item">
                        <div class="shipping-img">
                            <img src="~/assets/customer/images/shipping/icon/car.png" alt="Shipping Icon">
                        </div>
                        <div class="shipping-content">
                            <h2 class="title">Free Shipping</h2>
                            <p class="short-desc mb-0">Capped at $319 per order</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mt-4 mt-md-0">
                    <div class="shipping-item">
                        <div class="shipping-img">
                            <img src="~/assets/customer/images/shipping/icon/card.png" alt="Shipping Icon">
                        </div>
                        <div class="shipping-content">
                            <h2 class="title">Safe Payment</h2>
                            <p class="short-desc mb-0">With our payment gateway</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mt-4 mt-lg-0">
                    <div class="shipping-item">
                        <div class="shipping-img">
                            <img src="~/assets/customer/images/shipping/icon/service.png" alt="Shipping Icon">
                        </div>
                        <div class="shipping-content">
                            <h2 class="title">Best Services</h2>
                            <p class="short-desc mb-0">Friendly & Supper Services</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Shipping Area End Here -->
<!-- Begin Product Area -->
<div class="product-area section-space-top-100">
    <div class="container">
        <div class="section-title-wrap">
            <h2 class="section-title mb-0">Our Products</h2>
        </div>
        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="product-topbar pb-0 pt-3">
                    <ul>
                        <li class="short">
                            <select id="filterType" class="nice-select">
                                <option value="-1">Sort by Type</option>
                                @foreach (var item in type)
                                {
                                    <option value="@item.Value">@item.Text</option>
                                }
                            </select>
                        </li>
                        <li class="short">
                            <select  id="filterCategory" class="nice-select">
                                <option value="-1">Sort by Category</option>
                                @foreach (var item in category)
                                {
                                    <option value="@item.Value">@item.Text</option>
                                }
                            </select>
                        </li>
                    </ul>
                </div>
                <div id="dataContainer">
                    @{ Html.RenderAction("_ProductList", "Home", new { categoryId = -1, typeId = -1 });}
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Product Area End Here -->
@section scripts{
    <script type="text/javascript">
        $('.add-to-cart').on('click', function (e) {
            e.preventDefault();
            // Call action to add product to cart
            $.ajax({
                url: $(this).attr('href'),
                type: 'GET'
            }).done(function () {
                // Refresh mini cart
                getMiniCart();
                toastr.options.positionClass = 'toast-bottom-right';
                toastr["success"]("Add succeeded!");
            });
        });
        $("#filterCategory").change(function () {
            console.log("hihi");

            var typeId = $("#filterType").val();
            var categoryId = $("#filterCategory").val();
            GetProductList(typeId, categoryId)
        });
        $("#filterType").change(function () {
            var typeId = $("#filterType").val();
            var categoryId = $("#filterCategory").val();
            GetProductList(typeId, categoryId)
        });

        function GetProductList(typeId, categoryId) {
            console.log("hihi");
            $.ajax({
                url: '@Url.Action("_ProductList", "Home")',
                type: 'GET',
                data: {
                    categoryId: categoryId,
                    typeId: typeId,
                },               
            }).done(function (result) {
                $('#dataContainer').html(result);
            }).fail(function (XMLHttpRequest, textStatus, errorThrown) {
                console.log(textStatus)
                console.log(errorThrown)
                alert("Something Went Wrong, Try Later");
            });
        }
    </script>
}